{"version":3,"file":"cookie-policy.js","sources":["../../src/js/content.js","../../src/js/utils.js","../../src/js/api.js","../../src/js/notification.js","../../src/js/control.js","../../src/js/manager.js","../../src/js/main.js"],"sourcesContent":["export const controlsContent = [\n  {\n    id: 'essential',\n    enableSwitcher: false,\n    content: {\n      default: {\n        title: 'Essential',\n        description:\n          \"Enables the core functionality on our websites, such as navigation, access to secure areas, video players and payments. Our websites cannot function properly without these cookies; they can only be disabled by changing your browser preferences.\",\n        activeText: 'Always active',\n      },\n      zh: {\n        title: '必要性',\n        description:\n          '启用网站核心功能，例如导航，访问安全区域，视频播放器和支付。没有这些cookie网站不能正常工作；它们仅可通过修改浏览器偏好设置禁用。',\n        activeText: '默认接受',\n      },\n      ja: {\n        title: 'エッセンシャル',\n        description:\n          '移動、保護されている情報へのアクセス、動画再生、支払など、サイトの基本的な機能が有効になります。これらのクッキーが有効になっていない（お使いのブラウザの設定を変更することによってクッキーが無効化されている）場合、サイトは正しく表示されません。',\n        activeText: '常に有効',\n      },\n    },\n  },\n  {\n    id: 'performance',\n    enableSwitcher: true,\n    content: {\n      default: {\n        title: 'Performance',\n        description:\n          'Collects information on usage on our websites, for example, which pages are most frequently visited.',\n      },\n      zh: {\n        title: '表现性',\n        description: '网站使用信息收集，例如哪些网页被频繁访问。',\n      },\n      ja: {\n        title: 'パフォーマンス',\n        description:\n          'サイトの利用状況に関する情報を収集します。例として、どのページの訪問頻度が高いかのような情報です。',\n      },\n    },\n  },\n  {\n    id: 'functionality',\n    enableSwitcher: true,\n    content: {\n      default: {\n        title: 'Functional',\n        description:\n          'Recognizes you when you return to our websites. This enables us to personalize content, greet you by name, remember your preferences, and helps you share pages on social networks.',\n      },\n      zh: {\n        title: '功能性',\n        description:\n          '当你返回到我们网站时能识别您。这使得我们能个性化内容，欢迎您，记住您的偏好设置，以及帮助您分享网页到社交媒体。',\n      },\n      ja: {\n        title: '機能性',\n        description:\n          'お客様がサイトを再訪問したときに、お客様であることを認識します。この設定では、お客様に合わせたコンテンツの表示、お客様のお名前を用いたあいさつメッセージの表示、お客様の傾向の記録を当社が行えるようになります。また、お客様がソーシャルネットワークでページをシェアできるようになります。',\n      },\n    },\n  }\n];\n\nexport const content = {\n  default: {\n    notification: {\n      title: 'Your tracker settings',\n      body1:\n        'We use cookies and similar methods to recognize visitors and remember preferences. We also use them to measure campaign effectiveness and analyze traffic on our websites. By selecting ‘Accept‘, you consent to the use of these methods by us and trusted third parties. For further details or to change your consent choices at any time see our <a href=\"https://canonical.com/legal/data-privacy?cp=hide#cookies\">cookie policy</a>.',\n      buttonManage: 'Manage your tracker settings',\n      buttonAcceptAll: 'Accept all',\n    },\n    manager: {\n      title: 'Tracking choices',\n      body1:\n        'We use cookies to recognize visitors and remember your preferences. They enhance user experience, personalize content and ads, provide social media features, measure campaign effectiveness, and analyze traffic on our websites.',\n      body2:\n        'Select the types of trackers you consent to, both by us, and third parties. Learn more at <a href=\"https://canonical.com/legal/data-privacy?cp=hide#cookies\">data privacy: cookie policy</a> - you can change your choices at any time from the footer of the site.',\n      acceptAll: 'Accept all',\n      SavePreferences: 'Save preferences',\n    },\n  },\n\n  zh: {\n    notification: {\n      title: '您的追踪器设置',\n      body1:\n        '我们使用 cookie 和相似的方法来识别访问者和记住访问者的偏好设置，并用来衡量活动的效果和分析 Canonical 旗下所有网站的流量。选择”接受“，您同意我们和受信的第三方来使用这些资料。更多细节或者随时变更您的选择，请阅读我们的<a href=\"https://canonical.com/legal/data-privacy?cp=hide#cookies\"> cookie 策略</a>。',\n      buttonManage: '管理您的追踪器设置',\n      buttonAcceptAll: '接受',\n    },\n    manager: {\n      title: '追踪选项',\n      body1: '我们使用cookie来识别访问者和记住您的偏好设置 它们增强用户体验，使内容和广告个性化，提供社交媒体功能，衡量活动效果和网站流量分析。',\n      body2:\n        '选择您同意授予我们和受信的第三方的追踪类型。点击<a href=\"https://canonical.com/legal/data-privacy?cp=hide#cookies\">数据隐私：cookie策略</a>了解更多，您可以在网站底部随时更改您的选择。',\n      acceptAll: '接受全部',\n      SavePreferences: '保存偏好设置',\n    },\n  },\n\n  ja: {\n    notification: {\n      title: 'トラッキング機能の設定',\n      body1:\n        '当社は、当社のウェブサイトを訪問された方の識別や傾向の記録を行うために、クッキーおよび類似の手法を利用します。また、キャンペーンの効果の測定やサイトのトラフィックの分析にもクッキーを利用します。',\n      body2:\n        '「同意」を選択すると、当社および信頼できる第三者による上記の手法の利用に同意したものとみなされます。詳細または同意の変更については、いつでも当社の<a href=\"https://canonical.com/legal/data-privacy?cp=hide#cookies\">クッキーに関するポリシー</a>をご覧になることができます',\n      buttonManage: 'トラッキング機能の設定の管理',\n      buttonAcceptAll: '同意する',\n    },\n    manager: {\n      title: 'トラッキング機能の選択',\n      body1:\n        '当社は、当社のウェブサイトを訪問された方の識別や傾向の記録を行うために、クッキーを利用します。クッキーは、お客様の利便性の向上、お客様に合わせたコンテンツや広告の表示、ソーシャルメディア機能の提供、キャンペーンの効果の測定、サイトのトラフィックの分析に役立ちます。',\n      body2:\n        '当社および第三者によるトラッキング機能のタイプから、お客様が同意されるものをお選びください。詳細は、<a href=\"https://canonical.com/legal/data-privacy?cp=hide#cookies\">データプライバシー：クッキーに関するポリシー</a>をご覧ください。お客様が選んだ設定は、本サイトの下部からいつでも変更できます。',\n      acceptAll: 'すべて同意',\n      SavePreferences: '設定を保存',\n    },\n  },\n};\n","import { content } from \"./content.js\";\n\nconst DEFAULT_CONSENT = {\n  ad_storage: \"denied\",\n  ad_user_data: \"denied\",\n  ad_personalization: \"denied\",\n  analytics_storage: \"denied\",\n  functionality_storage: \"denied\",\n  personalization_storage: \"denied\",\n  security_storage: \"denied\",\n};\n\nconst ESSENTIAL_PREFERENCES = [\"security_storage\"];\n\nconst PERFORMANCE_PREFERENCES = [\n  \"ad_storage\",\n  \"ad_user_data\",\n  \"ad_personalization\",\n  \"analytics_storage\",\n];\n\nconst FUNCTIONALITY_PREFERENCES = [\n  \"functionality_storage\",\n  \"personalization_storage\",\n];\n\nconst ALL_PREFERENCES = [\n  \"ad_storage\",\n  \"ad_user_data\",\n  \"ad_personalization\",\n  \"analytics_storage\",\n  \"functionality_storage\",\n  \"personalization_storage\",\n];\n\nexport const setCookie = (value) => {\n  const d = new Date();\n  d.setTime(d.getTime() + 365 * 24 * 60 * 60 * 1000);\n  const expires = \"expires=\" + d.toUTCString();\n  const samesite = \"samesite=lax;\";\n  const path = \"path=/;\";\n  document.cookie =\n    \"_cookies_accepted=\" + value + \"; \" + expires + \"; \" + samesite + path;\n  if (enabledTracking(value)) {\n    pushPageview();\n  }\n};\n\nexport const getCookie = (targetCookie) => {\n  const splitArray = document.cookie.split(\";\");\n  let cookieValue = \"\";\n  let currentCookieValue = \"\";\n  for (let i = 0; i < splitArray.length; i++) {\n    let cookie = splitArray[i];\n    while (cookie.charAt(0) == \" \") {\n      cookie = cookie.substring(1);\n    }\n    currentCookieValue = cookie.substring(targetCookie.length, cookie.length);\n    if (cookie.indexOf(targetCookie) === 0 && currentCookieValue !== \"true\") {\n      cookieValue = currentCookieValue;\n    }\n  }\n  return cookieValue;\n};\n\nexport const preferenceNotSelected = () => {\n  const cookieValue = getCookie(\"_cookies_accepted=\");\n  // Skip a value of \"true\" and \"unset\" to override old existing cookies\n  if (cookieValue && cookieValue != \"true\" && cookieValue != \"unset\") {\n    return false;\n  } else {\n    return true;\n  }\n};\n\nexport const hideSpecified = () => {\n  const urlParams = new URLSearchParams(window.location.search);\n  const cpQuery = urlParams.get(\"cp\");\n\n  if (cpQuery === \"hide\") {\n    return true;\n  } else {\n    return false;\n  }\n};\n\nexport const getContent = (language) => {\n  if (content[language]) {\n    return content[language];\n  } else {\n    return content[\"default\"];\n  }\n};\n\nexport const getControlsContent = (details, language) => {\n  if (details.content[language]) {\n    return details.content[language];\n  } else {\n    return details.content[\"default\"];\n  }\n};\n\nexport const addGoogleConsentMode = () => {\n  // Check for existing gtag before adding the default script\n  if (!window.gtag) {\n    // Run the script to define gtag\n    window.dataLayer = window.dataLayer || [];\n    window.gtag = function gtag() {\n      dataLayer.push(arguments);\n    };\n\n    // Set default consent to 'denied' as a placeholder\n    window.gtag(\"consent\", \"default\", DEFAULT_CONSENT);\n  }\n};\n\nexport const loadConsentFromCookie = () => {\n  const cookieValue = getCookie(\"_cookies_accepted=\");\n  cookieValue && setGoogleConsentPreferences(cookieValue);\n};\n\nexport const setGoogleConsentFromControls = (controls) => {\n  const checkedControls = controls.filter((control) => control.isChecked());\n\n  let updatedConsent = { ...DEFAULT_CONSENT };\n\n  // We combine the preferences into a single object\n  checkedControls.forEach((item) => {\n    updatedConsent = updateConsentPreferences(updatedConsent, item.id);\n  });\n\n  // Insert the script at the bottom of the head section\n  runConsentScript(updatedConsent);\n};\n\nexport const setGoogleConsentPreferences = (selectedPreference) => {\n  let updatedConsent = updateConsentPreferences(\n    DEFAULT_CONSENT,\n    selectedPreference\n  );\n\n  // Insert the script at the bottom of the head section\n  runConsentScript(updatedConsent);\n};\n\nconst updateConsentPreferences = (consentObject, selectedPreference) => {\n  let updatedConsent = { ...consentObject };\n\n  ESSENTIAL_PREFERENCES.forEach((item) => {\n    updatedConsent[item] = \"granted\";\n  });\n\n  if (selectedPreference === \"performance\") {\n    PERFORMANCE_PREFERENCES.forEach((item) => {\n      updatedConsent[item] = \"granted\";\n    });\n  } else if (selectedPreference === \"functionality\") {\n    FUNCTIONALITY_PREFERENCES.forEach((item) => {\n      updatedConsent[item] = \"granted\";\n    });\n  } else if (selectedPreference === \"all\") {\n    ALL_PREFERENCES.forEach((item) => {\n      updatedConsent[item] = \"granted\";\n    });\n  }\n\n  return updatedConsent;\n};\n\nconst runConsentScript = (consentObject) => {\n  // Update preferences\n  window.gtag(\"consent\", \"update\", consentObject);\n};\n\nconst pushPageview = () => {\n  if (typeof dataLayer === \"object\") {\n    dataLayer.push({ event: \"pageview\" });\n  }\n};\n\nconst enabledTracking = (selectedPreference) => {\n  if (selectedPreference == \"all\" || selectedPreference == \"performance\") {\n    return true;\n  } else {\n    return false;\n  }\n};\n\n    \n/**\n  Toggles the necessary aria- attributes' values on the accordion panels\n  and handles to show or hide them.\n  @param {HTMLElement} element The tab that acts as the handles.\n  @param {Boolean} show Whether to show or hide the accordion panel.\n*/\nfunction toggleExpanded(element, show) {\n  let target = document.getElementById(element.getAttribute('aria-controls'));\n\n  if (target) {\n    element.setAttribute('aria-expanded', show);\n    target.setAttribute('aria-hidden', !show);\n  }\n}\n\n/**\n  Attaches event listeners for the accordion open and close click events.\n  @param {HTMLElement} accordionContainer The accordion container element.\n*/\nexport const setupAccordion = (accordionContainer) => {\n  // Finds any open panels within the container and closes them.\n  function closeAllPanels() {\n    let openPanels = accordionContainer.querySelectorAll('[aria-expanded=true]');\n\n    for (let i = 0, l = openPanels.length; i < l; i++) {\n      toggleExpanded(openPanels[i], false);\n    }\n  }\n\n  // Set up an event listener on the container so that panels can be added\n  // and removed and events do not need to be managed separately.\n  accordionContainer.addEventListener('click', function(event) {\n    let target = event.target;\n\n    if (target.closest) {\n      target = target.closest('[class*=\"p-accordion__tab\"]');\n    }\n\n    if (target) {\n      let isTargetOpen = target.getAttribute('aria-expanded') === 'true';\n\n      // Toggle visibility of the target panel.\n      toggleExpanded(target, !isTargetOpen);\n    }\n  });\n}\n\n\n/**\n * Handles closing the notification/modal with a specific preference.\n * If available, POSTs the preferences to shared cookie service.\n * @param {string} preference - The cookie preference (e.g., \"essential\" or \"all\").\n * @param {Function} destroyComponent - The function to destroy the component.\n * @returns {Function} - The event handler function.\n */\nexport const handleClose = (preference, destroyComponent) => () => {\n  setCookie(preference);\n  setGoogleConsentPreferences(preference);\n  destroyComponent();\n};\n","import { getCookie } from \"./utils.js\";\n\n/*\n * POSTs updated preferences to the shared cookie service endpoint\n * via the canonicalwebteam.cookie_service package \n **/\nexport function postUpdatedPreferences() {\n  // Check if cookie service is enabled\n  const cookieServiceUp = getCookie(\"_cookies_service_up=\");\n  if (!cookieServiceUp || cookieServiceUp !== \"1\") {\n    return;\n  }\n  // Check if preferences cookie exists\n  const cookieAcceptanceValue = getCookie(\"_cookies_accepted=\");\n  if (!cookieAcceptanceValue) {\n    return;\n  }\n  // POST to the backend endpoint\n  // Which then POSTs to cookies.canonical.com\n  fetch(\"/cookies/set-preferences\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify({\"preferences\": {\"consent\": cookieAcceptanceValue}})\n  })\n  .catch(err => console.error(\"Error sending preferences:\", err));\n}","import {\n  handleClose,\n  getContent,\n  getCookie,\n  setCookie,\n  setGoogleConsentPreferences,\n} from \"./utils.js\";\nimport { postUpdatedPreferences } from \"./api.js\";\n\nexport class Notification {\n  constructor(container, renderManager, destroyComponent) {\n    this.container = container;\n    this.renderManager = renderManager;\n    this.destroyComponent = destroyComponent;\n  }\n\n  getNotificationMarkup(language) {\n    const notificationContent = getContent(language).notification;\n    const notification = `\n      <div class=\"p-modal cookie-notification-modal\" id=\"modal\">\n        <div class=\"p-modal__dialog\" role=\"dialog\" aria-labelledby=\"cookie-policy-title\" aria-describedby=\"cookie-policy-content\">\n        <header class=\"p-modal__header grid-row\">\n          <h2 class=\"p-modal__title p-heading--4\" id=\"cookie-policy-title\">${notificationContent.title}</h2>\n        </header>\n        <div id=\"cookie-policy-content\" class=\"grid-row\">\n          <div class=\"grid-col-5\">\n            <p class=\"u-no-max-width${notificationContent.body2 ? ' u-no-margin--bottom' : ''}\">${notificationContent.body1}</p>\n            ${notificationContent.body2 ? `<p class=\"u-no-max-width\">${notificationContent.body2}</p> ` : ''}\n          </div>\n          <div class=\"cookie-notification-buttons grid-col-3 u-vertically-center\">\n            <p class=\"u-no-margin--bottom\">\n              <button class=\"p-button--link is-inline js-manage\">${notificationContent.buttonManage}</button>\n              <button class=\"p-button--positive js-close-all\" id=\"cookie-policy-button-accept-all\">${notificationContent.buttonAcceptAll}</button>\n            </p>\n          </div>\n        </div>`;\n\n    return notification;\n  }\n\n  render(language) {\n    this.container.innerHTML = this.getNotificationMarkup(language);\n    this.initaliseListeners();\n  }\n\n  initaliseListeners() {\n    this.container\n      .querySelector(\".js-close-all\")\n      .addEventListener(\"click\", () => {\n        handleClose(\"all\", this.destroyComponent)();\n        postUpdatedPreferences();\n      });\n\n    this.container\n      .querySelector(\".js-manage\")\n      .addEventListener(\"click\", () => {\n        this.renderManager();\n      });\n  }\n}\n","import { getControlsContent, getCookie } from \"./utils.js\";\n\nexport class Control {\n  constructor(details, container, language) {\n    this.language = language;\n    this.id = details.id;\n    this.title = getControlsContent(details, language).title;\n    this.description = getControlsContent(details, language).description;\n    this.activeText = getControlsContent(details, language).activeText;\n    this.enableSwitcher = details.enableSwitcher;\n    this.container = container;\n    this.element;\n    this.onChange = details.onChange || (() => {});\n\n    // Rendering off the bat here as this is a dumb component.\n    // It saves creating a variable and calling .render() on it.\n    this.render();\n  }\n\n  render() {\n    const isChecked = this.cookieIsTrue();\n\n    const control = document.createElement(\"div\");\n    control.innerHTML = `\n    <li class=\"controls p-accordion__group\">                \n      <div role=\"heading\" aria-level=\"3\" class=\"p-accordion__heading\">\n        <button type=\"button\" class=\"p-accordion__tab\" id=\"${this.id}-tab\" aria-controls=\"${this.id}-section\" aria-expanded=\"false\">\n          <span class=\"p-heading--5 u-no-padding--top u-no-margin--bottom\" style=\"margin-right: 1rem;\">${this.title}</span>\n          ${\n            !this.enableSwitcher ? \n            `<span class=\"p-accordion__switch u-text--muted u-align--right\">${this.activeText}</span>` : `\n            ${\n            `<label class=\"p-accordion__switch u-align--right u-no-margin--bottom p-switch\">\n              <input type=\"checkbox\" class=\"p-switch__input js-${this.id}-switch\" ${\n                  (isChecked || !this.enableSwitcher) && 'checked=\"\" '\n                }\n                ${\n                  !this.enableSwitcher && `disabled=\"disabled\"`\n\n                }>            \n              <span class=\"p-switch__slider\"></span>\n            </label>\n            `\n          }\n        `}\n        </button>\n        \n      </div>\n      <section class=\"p-accordion__panel\" id=\"${this.id}-section\" aria-hidden=\"true\" aria-labelledby=\"${this.id}-tab\">\n        <p>${this.description}</p>\n      </section>\n    </li>\n    <hr class=\"p-rule--muted\" />\n    `;\n    this.container.appendChild(control);\n    this.element = control.querySelector(`.js-${this.id}-switch`);\n    this.element?.addEventListener(\"change\", this.onChange);\n  }\n\n  cookieIsTrue() {\n    const cookieValue = getCookie(\"_cookies_accepted=\");\n\n    // If the cookie value matches the control ID, return true\n    if (cookieValue) {\n      if (cookieValue === this.id || cookieValue === \"all\") {\n        return true;\n      }\n    }\n    return cookieValue && cookieValue === this.id;\n  }\n\n  // The check should be false by default\n  isChecked() {\n    return this.element ? this.element.checked : false;\n  }\n\n  getId() {\n    return this.id;\n  }\n}\n","import {\n  setCookie,\n  getContent,\n  setGoogleConsentFromControls,\n  setupAccordion,\n  handleClose,\n} from \"./utils.js\";\nimport { Control } from \"./control.js\";\nimport { controlsContent } from \"./content.js\";\nimport { postUpdatedPreferences } from \"./api.js\";\n\nexport class Manager {\n  constructor(container, destroyComponent) {\n    this.container = container;\n    this.controlsStore = [];\n    this.destroyComponent = destroyComponent;\n  }\n\n  getManagerMarkup(language) {\n    const managerContent = getContent(language).manager;\n    const manager = `\n      <div class=\"p-modal cookie-manager-modal\" id=\"modal\">\n        <section class=\"p-modal__dialog\" role=\"dialog\" aria-labelledby=\"cookie-policy-title\" aria-describedby=\"cookie-policy-content\">\n          <header class=\"p-modal__header\">\n            <h2 class=\"p-modal__title p-heading--4\" id=\"cookie-policy-title\">${managerContent.title}</h2>\n          </header>\n          <div id=\"cookie-policy-content\">\n            <p>${managerContent.body1}</p>\n            <p>${managerContent.body2}</p>\n            ${managerContent.body3 ? `<p>${managerContent.body3}</p>` : ''}\n            <aside class=\"p-accordion\">\n              <ul class=\"p-accordion__list controls\">\n              </ul>\n            </aside>\n            <p class=\"u-no-margin--bottom u-float-right\">\n              <button class=\"p-button--positive js-close\" id=\"cookie-policy-button-accept-all\">${managerContent.acceptAll}</button>\n              <button class=\"p-button js-save-preferences\">${managerContent.SavePreferences}</button>\n            </p>\n          </div>\n        </section>\n      </div>`;\n\n    return manager;\n  }\n\n  render(language) {\n    this.container.innerHTML = this.getManagerMarkup(language);\n    const controlsContainer = this.container.querySelector(\".controls\");\n    controlsContent.forEach((controlDetails) => {\n      const control = new Control(\n        { ...controlDetails, onChange: () => this.updateAcceptButton() },\n        controlsContainer,\n        language\n      );\n      this.controlsStore.push(control);\n    });\n    this.updateAcceptButton();\n    this.initaliseListeners();\n  }\n\n  updateAcceptButton() {\n    const allChecked = this.controlsStore\n      .filter((control) => control.getId() !== \"essential\")\n      .every((control) => control.isChecked());\n    const button = this.container.querySelector(\".js-close\");\n    button.style.display = allChecked ? \"none\" : \"inline-block\";\n  }\n\n  initaliseListeners() {\n    this.container\n      .querySelector(\".js-close\")\n      .addEventListener(\"click\", () => {\n        handleClose(\"all\", this.destroyComponent)();\n        postUpdatedPreferences();\n      });\n    \n    // Setup all accordions on the page\n    let accordions = document.querySelectorAll('.p-accordion');\n    for (let i = 0, l = accordions.length; i < l; i++) {\n      setupAccordion(accordions[i]);\n    }\n    this.container\n      .querySelector(\".js-save-preferences\")\n      .addEventListener(\"click\", () => {\n        this.savePreferences();\n        postUpdatedPreferences();\n        this.destroyComponent();\n      });\n  }\n\n  savePreferences() {\n    const checkedControls = this.controlsStore.filter((control) =>\n      control.isChecked()\n    );\n\n    // \"essential\" is the default value for only essential cookies\n    if (this.controlsStore.length - 1 === checkedControls.length) {\n      setCookie(\"all\");\n    } else if (checkedControls.length === 0) {\n      setCookie(\"essential\");\n    } else {\n      this.controlsStore.forEach((control) => {\n        if (control.isChecked()) {\n          // Note: this overwrites the previous cookie\n          setCookie(control.getId());\n        }\n      });\n    }\n\n    setGoogleConsentFromControls(this.controlsStore);\n  }\n}","import { Notification } from \"./notification.js\";\nimport { Manager } from \"./manager.js\";\nimport {\n  preferenceNotSelected,\n  hideSpecified,\n  addGoogleConsentMode,\n  loadConsentFromCookie,\n} from \"./utils.js\";\n\n// Add Google Consent Mode as soon as the script is loaded\naddGoogleConsentMode();\n\nexport const cookiePolicy = (callback = null) => {\n  let cookiePolicyContainer = null;\n  let language = document.documentElement.lang;\n  let initialised = false;\n\n  const renderNotification = function (e) {\n    if (e) {\n      e.preventDefault();\n    }\n\n    if (cookiePolicyContainer === null) {\n      cookiePolicyContainer = document.createElement(\"dialog\");\n      cookiePolicyContainer.classList.add(\"cookie-policy\");\n      cookiePolicyContainer.style.pointerEvents = \"none\";\n      cookiePolicyContainer.setAttribute(\"open\", true);\n      cookiePolicyContainer.style.borderStyle = \"none\";\n      document.body.appendChild(cookiePolicyContainer);\n      const notification = new Notification(\n        cookiePolicyContainer,\n        renderManager,\n        close\n      );\n      notification.render(language);\n      document.getElementById(\"cookie-policy-button-accept-all\").focus();\n    }\n  };\n\n  const renderManager = function () {\n    const manager = new Manager(cookiePolicyContainer, close);\n    manager.render(language);\n  };\n\n  const close = function () {\n    if (typeof callback === \"function\") {\n      callback();\n    }\n    document.body.removeChild(cookiePolicyContainer);\n    cookiePolicyContainer = null;\n  };\n\n  const init = function () {\n    if (initialised) return;\n    initialised = true;\n\n    // Load the consent from the cookie, if available\n    loadConsentFromCookie();\n\n    const revokeButton = document.querySelector(\".js-revoke-cookie-manager\");\n    if (revokeButton) {\n      revokeButton.addEventListener(\"click\", renderNotification);\n    }\n\n    if (preferenceNotSelected() && !hideSpecified()) {\n      renderNotification();\n    }\n  };\n\n  if (document.readyState === \"loading\") {\n    // If the document is still loading, listen for DOMContentLoaded\n    document.addEventListener(\"DOMContentLoaded\", init, false);\n  } else {\n    // Otherwise the script was triggered after the document was loaded, so we can run it immediately\n    init();\n  }\n};\n"],"names":["controlsContent","id","enableSwitcher","content","default","title","description","activeText","zh","ja","notification","body1","buttonManage","buttonAcceptAll","manager","body2","acceptAll","SavePreferences","DEFAULT_CONSENT","ad_storage","ad_user_data","ad_personalization","analytics_storage","functionality_storage","personalization_storage","security_storage","ESSENTIAL_PREFERENCES","PERFORMANCE_PREFERENCES","FUNCTIONALITY_PREFERENCES","ALL_PREFERENCES","setCookie","value","d","Date","setTime","getTime","expires","toUTCString","document","cookie","enabledTracking","pushPageview","getCookie","targetCookie","splitArray","split","cookieValue","currentCookieValue","i","length","charAt","substring","indexOf","getContent","language","getControlsContent","details","setGoogleConsentPreferences","selectedPreference","updatedConsent","updateConsentPreferences","runConsentScript","consentObject","_objectSpread","forEach","item","window","gtag","_typeof","dataLayer","push","event","setupAccordion","accordionContainer","addEventListener","target","closest","isTargetOpen","getAttribute","element","show","getElementById","setAttribute","toggleExpanded","handleClose","preference","destroyComponent","postUpdatedPreferences","cookieServiceUp","cookieAcceptanceValue","fetch","method","headers","body","JSON","stringify","preferences","consent","catch","err","console","error","Notification","_createClass","container","renderManager","_classCallCheck","this","key","notificationContent","concat","innerHTML","getNotificationMarkup","initaliseListeners","_this","querySelector","Control","onChange","render","_this$element","isChecked","cookieIsTrue","control","createElement","appendChild","checked","Manager","controlsStore","managerContent","body3","getManagerMarkup","controlsContainer","controlDetails","updateAcceptButton","allChecked","filter","getId","every","style","display","_this2","accordions","querySelectorAll","l","savePreferences","checkedControls","controls","setGoogleConsentFromControls","arguments","callback","undefined","cookiePolicyContainer","documentElement","lang","initialised","renderNotification","e","preventDefault","classList","add","pointerEvents","borderStyle","close","focus","removeChild","init","revokeButton","preferenceNotSelected","URLSearchParams","location","search","get","readyState"],"mappings":"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"}